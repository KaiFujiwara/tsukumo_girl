# ゲーム設計

## ゲームコンセプト

### コアループ
```
バーコードスキャン → キャラクター発見/生成 → コミュニケーション → 好感度上昇 → 所有権争奪
```

## キャラクター所有システム

### 所有権の概念
- **カノジョ**: 1人のユーザーが独占的に保持できる関係
- **好感度競争**: 他ユーザーとの好感度競争
- **所有権移転**: 好感度逆転による所有権変更

### 好感度システム

#### 好感度レベル
```
0-20:   知らない人 (stranger)
21-40:  友達 (friend)  
41-70:  恋人 (lover)
71-100: パートナー (partner)
```

#### 好感度獲得方法
```
行動                    獲得好感度
─────────────────────────────────
初回スキャン（新規）        +10
既存キャラクターとチャット    +1-3（内容次第）
連続ログイン              +1/日
特別なイベント            +5-10
ギフト機能（将来）          +3-7
```

#### 好感度減少
```
行動                    減少好感度
─────────────────────────────────
長期間ログインなし          -1/週
不適切な発言              -2-5
他ユーザーとの交流        -1（嫉妬システム）
```

### 所有権移転ルール

#### 移転条件
1. **好感度逆転**: 挑戦者の好感度 > 現所有者の好感度
2. **最低閾値**: 挑戦者の好感度 ≥ 30（友達レベル以上）
3. **クールダウン**: 移転後24時間は次の移転不可

#### 移転プロセス
```
1. 好感度チェック（リアルタイム）
2. 移転条件判定
3. 通知送信（現所有者・新所有者）
4. 所有権データ更新
5. 履歴記録
```

## コミュニケーションシステム

### キャラクター性格生成

#### 性格パラメータ（0-100）
```json
{
  "cheerfulness": 75,    // 明るさ
  "shyness": 40,        // 恥ずかしがり
  "intelligence": 85,    // 知性
  "playfulness": 60,     // お茶目さ
  "loyalty": 90,        // 忠実さ
  "independence": 50     // 自立性
}
```

#### バーコードからの性格決定
```go
// シード値から性格パラメータを決定論的に生成
func generatePersonality(seed uint32) Personality {
    rng := rand.New(rand.NewSource(int64(seed)))
    return Personality{
        Cheerfulness:  rng.Intn(101),
        Shyness:      rng.Intn(101),
        Intelligence: rng.Intn(101),
        // ...
    }
}
```

### 会話AI統合

#### プロンプト設計
```
あなたは{{character_name}}という名前の美少女キャラクターです。

性格:
- 明るさ: {{cheerfulness}}/100
- 恥ずかしがり: {{shyness}}/100
- 知性: {{intelligence}}/100

現在の関係: {{relationship_status}}
好感度: {{affection_level}}/100

{{user_name}}さんとの会話を{{character_name}}として続けてください。
性格に基づいて自然に応答し、好感度に応じて親密度を調整してください。
```

## ゲーム要素

### 収集・育成要素
- **キャラクター収集**: 様々な商品をスキャンして新キャラクター発見
- **好感度育成**: コミュニケーションによる関係深化
- **レア度システム**: 特定商品からのレアキャラクター（将来）

### 競争要素
- **所有権争奪**: 他ユーザーとの好感度競争
- **ランキング**: キャラクター別好感度ランキング
- **実績システム**: スキャン数、好感度達成等（将来）

### ソーシャル要素
- **発見共有**: 新キャラクター発見の通知
- **所有権移転通知**: 所有権変更の通知
- **ランキング表示**: 人気キャラクター・トップユーザー

## バランス調整

### 好感度バランス
- **新規ユーザー優遇**: 初回ボーナス
- **継続ユーザー優遇**: デイリーボーナス
- **アクティブ度重視**: チャット頻度による重み付け

### キャラクター価値
- **スキャン頻度**: 人気商品のキャラクターは競争激化
- **レア度**: 珍しい商品からのキャラクターは高価値
- **初期ユーザー優遇**: 新規発見ボーナス

## プレイヤー体験

### 理想的なプレイフロー
1. **発見の喜び**: 新商品スキャンで新キャラクター発見
2. **育成の楽しみ**: 日々の会話で関係構築
3. **競争の緊張感**: 他ユーザーからの挑戦
4. **達成感**: 高好感度・所有権維持

### リテンション施策
- **デイリーログインボーナス**
- **週間イベント**（将来）
- **新キャラクター通知**
- **所有権危機アラート**